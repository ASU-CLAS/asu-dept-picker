(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * @file
 * Javascript for ASU Dept Picker
 *
 * Requires React/ReactDOM
 */
var AsuDeptPicker = require('./components/asu-dept-picker.jsx');

/**
 * Provides an ASU department picker widget.
 */
(function ($) {
  Drupal.behaviors.asu_dept_picker = {
    attach: function(context, settings) {
      // setup any asu-dept-picker fields
      $('.asu-dept-picker:not([data-reactid])', context).each(function() {
        var delta = $(this).attr('data-delta');
        var config = settings.asu_dept_picker[delta];

        var asu_dept_picker = React.createElement(AsuDeptPicker, config);
        ReactDOM.render(asu_dept_picker, this);
      });
    }
  }
})(jQuery);


},{"./components/asu-dept-picker.jsx":2}],2:[function(require,module,exports){
/**
 * ASU Department Picker Component
 */
var DeptTree = require('./dept-tree');
var DeptList = require('./dept-list');
var Modal = require('./modal');


module.exports = React.createClass({displayName: "exports",
  getInitialState: function() {
    return {
      config: {items: [], options: {}},
      selectedDepartments: [],
      currentNode: null,
      includeSubdepts: false
    };
  },

  render: function() {
    return React.createElement("div", {className: "widget-asu-dept-picker"}, 
      this.renderBrowseButton(), 
      this.renderDepartmentList(), 
      this.renderModal()
    )
  },

  renderModal: function() {
    var deptTree = React.createElement(DeptTree, React.__spread({
      ref: "deptTree"},  this.props, 
      {onTreeClick: this.handleDeptTreeClick})
    )

    return React.createElement(Modal, {
      ref: "modal", 
      title: "Select Department", 
      content: deptTree, 
      onSuccess: this.handleModalSuccess, 
      onSubdeptClick: this.handleSubdeptClick}
    );
  },

  renderDepartmentList: function() {
    return React.createElement(DeptList, {
      ref: "deptList", 
      onRemoveDept: this.handleRemoveDept, 
      items: this.state.selectedDepartments}
    )
  },

  renderBrowseButton: function() {
    return React.createElement("div", {className: "browse-button"}, 
      React.createElement("input", {type: "button", 
        value: "Browse", 
        className: "form-submit", 
        onClick: this.handleBrowseClick}
      )
    )
  },

  handleRemoveDept: function(doomed) {
    var dept_id = doomed.props.id;
    var config = this.state.config;

    config.items = config.items.filter(function(item){
      return (dept_id != item.dept_id);
    });

    delete config.options[dept_id];

    this.setState({ config: config });

    this.setSelectedDepartments();
  },

  handleSubdeptClick: function() {
    this.setState({ includeSubdepts: !this.state.includeSubdepts });
  },

  handleModalSuccess: function() {
    // setup config
    this.setDeptConfig(this.refs.deptTree.state.currentNode);

    // update selected departments list
    this.setSelectedDepartments();
  },

  handleBrowseClick: function(event) {
    this.refs.modal.show();
  },

  handleDeptTreeClick: function(data) {
    this.setState({ currentNode: data.node });
  },

  setSelectedDepartments: function() {
    var deptTree = this.refs.deptTree;
    var config = this.state.config;
    var depts = [];

    config.items.map(function(item, index){
      depts.push({
        id: item.dept_id,
        title: deptTree.getDeptPath(item.tid),
        subdepts: config.options[item.dept_id].subdepts
      });
    });

    this.setState({ selectedDepartments: depts });
  },

  setDeptConfig: function(data) {
    // get the tree path to set the label
    var config = this.state.config;

    var unique = true;
    config.items.map(function(item, index) {
      if (item.dept_nid == data.dept_nid) {
        unique = false;
        config.options[item.dept_id].subdepts = this.state.includeSubdepts;
      }
    }.bind(this));

    if (unique) {
      config.items.push({
        'dept_id': data.dept_id,
        'dept_nid': data.dept_nid,
        'tree_nids': data.tree_nids,
        'tid': data.tid
      });

      config.options[data.dept_id] = {
        subdepts: this.state.includeSubdepts
      };
    }

    this.setState({ config: config });
  }
});


},{"./dept-list":4,"./dept-tree":5,"./modal":6}],3:[function(require,module,exports){
/**
 * ASU Department List Item Component
 */
module.exports = React.createClass({displayName: "exports",
  handleItemRemove: function(event) {
    this.props.onRemoveDept(this);
  },

  render: function() {
    return React.createElement("li", {ref: "dept"}, 
      this.props.title, 
      this.renderSubdeptsLabel(), 
      React.createElement("span", {className: "tag remove"}, 
        React.createElement("span", {
          onClick: this.handleItemRemove, 
          className: "fa fa-close"})
      )
    )
  },

  renderSubdeptsLabel: function() {
    if (this.props.subdepts) {
      return React.createElement("span", {className: "tag subdepts"}, "+subdepts")
    }
  }
});


},{}],4:[function(require,module,exports){
/**
 * ASU Department Picker Component
 */
var DeptListItem = require('./dept-list-item');

module.exports = React.createClass({displayName: "exports",
  render: function() {
    return React.createElement("ul", {className: "asu-dept-list"}, 
      this.renderList()
    )
  },

  renderList: function() {
    return this.props.items.map(function(item) {
      return React.createElement(DeptListItem, {
        key: item.id, 
        onRemoveDept: this.props.onRemoveDept, 
        subdepts: item.subdepts, 
        id: item.id, 
        title: item.title}
      )
    }.bind(this));
  },
});


},{"./dept-list-item":3}],5:[function(require,module,exports){
var $ = jQuery;

/**
 * Department Tree Component
 */
module.exports = React.createClass({displayName: "exports",
  getInitialState: function() {
    return {
      treeData: JSON.parse(this.props.tree_json_data),
      currentNode: {
        dept_id: 1234,
      }
    }
  },
  componentDidMount: function() {
    // initialize tree plugin...
    var el = this.refs.treeWidget;
    var tree_data = this.state.treeData;
    var topLevel = 10;

    var defaults = {
      openAt: 1,
      showOnly: null,
      autoOpen: 0
    };
    options = $.extend(defaults, this.props);

    $(el).tree({
      data: tree_data,
      closedIcon: $('<span class="fa fa-plus-circle"></span>'),
      openedIcon: $('<span class="fa fa-minus-circle"></span>'),

      // First level open
      autoOpen: options.autoOpen,
      selectable: true,

      // Assign dept_id attribute to each tree <li>
      onCreateLi: function (node, $li) {
        $li.attr('dept_nid', node.dept_nid);
        $li.attr('dept_id', node.dept_id);

        if (options.showOnly && Array.isArray(options.showOnly) && options.showOnly.length) {
          $(el).addClass('trimmed');

          $.each(options.showOnly, function(index, item){
            if (item == node.dept_nid || node.dept_id == 'ASU') {
              $li.addClass('visible');
            }
          });
        }

        if (!node.hasChildren()) {
          $li.find('.jqtree-element').prepend('<span class="jqtree-folder-icon fa fa-bookmark"></span>');
        }
      }
    });

    $(el).bind('tree.click', this.onTreeClick);
  },
  render: function() {
    return React.createElement("div", {className: "asu-dept-tree"}, 
      React.createElement("div", {className: "tree-wrapper", ref: "treeWidget"}, "Tree widget")
    )
  },
  onTreeClick: function(event) {
    event.node.tree_nids = this.getTreeIds(event.node);
    this.setState({ currentNode: event.node });
    this.props.onTreeClick(event);
  },
  getDeptPath: function(dept_tid, path, reverse) {
    switch (arguments.length) {
      case 1: path = [];
      case 2: reverse = true;
    }

    if (item = this.findRootDept(dept_tid, 'tid')) {

      var className = ['fragment'];

      if (item.parents[0] == '0') {
        // abbreviate Arizona State University
        item.name = 'ASU';
        className.push('first');
      }
      if (item.children.length == 0) {
        className.push('last');
      }

      path.push(React.createElement("span", {key: dept_tid, className: className.join(' ')}, item.name));
      if (item.parents.length) {
        path = this.getDeptPath(item.parents[0], path, false);
      }
    }

    if (reverse) {
      path = path.reverse();
    }

    return path;
  },
  getTreeIds: function(tree, tree_ids) {
    if (arguments.length == 1) {
      tree_ids = [];
    }

    tree_ids.push(tree.dept_nid);

    for (var i = 0; i < tree.children.length; i++) {
      this.getTreeIds(tree.children[i], tree_ids);
    }

    return tree_ids;
  },
  findRootDept: function(dept_id, id_type, data) {
    var dept = null;

    switch(arguments.length) {
      case 1:
        id_type = 'dept_nid';
      case 2:
        data = this.state.treeData;
        break;
    }

    if (arguments.length == 1) {
      id_type = 'dept_nid';
    }

    for (var i = 0; i < data.length; i++) {
      if (dept == null && data[i] != null) {
        if (data[i][id_type] == dept_id) {
          return data[i];
        }
        else if (data[i].hasOwnProperty('children')) {
          dept = this.findRootDept(dept_id, id_type, data[i].children);
        }
      }
      else {
        break;
      }
    }
    return dept;
  }
});


},{}],6:[function(require,module,exports){
/**
 * Department Tree Component
 */
var DeptTree = require('./dept-tree');

module.exports = React.createClass({displayName: "exports",
  componentDidMount: function() {
    document.addEventListener('keyup', function(e) {
      if (e.keyCode == 27) {
        this.hide();
      }
    }.bind(this));
  },

  getInitialState: function() {
    return {
      open: false
    }
  },

  render: function() {

    var modalClass = (this.state.open ? 'dialog-open' : '');

    return React.createElement("div", {className: "asu-dept-picker-modal " + modalClass}, 
      React.createElement("div", {className: "dialog"}, 
        React.createElement("div", {className: "dialog-title"}, 
          this.props.title, 
          React.createElement("div", {className: "close-dialog", onClick: this.handleCancelClick}, 
            React.createElement("span", {className: "fa fa-close"})
          )
        ), 
        this.props.content, 
        React.createElement("div", {className: "actions"}, 
          React.createElement("div", {className: "form-item form-type-checkbox"}, 
            React.createElement("input", {
              ref: "include_subdept", 
              type: "checkbox", 
              className: "form-checkbox", 
              onClick: this.handleSubdeptClick, 
              defaultChecked: this.state.includeSubdepts ? 'checked' : ''}
            ), 
            React.createElement("label", {className: "option", onClick: this.handleLabelClick}, " Include sub-departments?"), 
            React.createElement("div", {className: "description", style: {'display': 'none'}}, 
              "This will include all sub-departments beneath the selected department."
            )
          ), 
          React.createElement("input", {type: "button", 
            className: "form-submit", 
            onClick: this.handleSubmitClick, 
            value: "Submit"}
          ), 
          React.createElement("input", {type: "button", 
            className: "form-submit", 
            onClick: this.handleCancelClick, 
            value: "Cancel"}
          )
        )
      )
    )
  },

  handleSubdeptClick: function() {
    if (this.props.onSubdeptClick) {
      this.props.onSubdeptClick();
    }
  },

  handleLabelClick: function() {
    this.refs.include_subdept.click();
  },

  handleCancelClick: function() {
    if (this.props.onCancelClick) {
      this.props.onCancelClick();
    }

    this.hide();
  },

  handleSubmitClick: function() {
    if (this.props.onSuccess) {
      this.props.onSuccess();
    }

    this.hide();
  },

  show: function() {
    this.setState({ open: true });
  },

  hide: function() {
    this.setState({ open: false });
  }
});

},{"./dept-tree":5}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvc2ViYXN0aWFuL3d3dy9hc3VfZGVwdF9waWNrZXIvc3JjL21haW4uanN4IiwiL1VzZXJzL3NlYmFzdGlhbi93d3cvYXN1X2RlcHRfcGlja2VyL3NyYy9jb21wb25lbnRzL2FzdS1kZXB0LXBpY2tlci5qc3giLCIvVXNlcnMvc2ViYXN0aWFuL3d3dy9hc3VfZGVwdF9waWNrZXIvc3JjL2NvbXBvbmVudHMvZGVwdC1saXN0LWl0ZW0uanN4IiwiL1VzZXJzL3NlYmFzdGlhbi93d3cvYXN1X2RlcHRfcGlja2VyL3NyYy9jb21wb25lbnRzL2RlcHQtbGlzdC5qc3giLCIvVXNlcnMvc2ViYXN0aWFuL3d3dy9hc3VfZGVwdF9waWNrZXIvc3JjL2NvbXBvbmVudHMvZGVwdC10cmVlLmpzeCIsIi9Vc2Vycy9zZWJhc3RpYW4vd3d3L2FzdV9kZXB0X3BpY2tlci9zcmMvY29tcG9uZW50cy9tb2RhbC5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTs7R0FFRztBQUNILElBQUksYUFBYSxHQUFHLE9BQU8sQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDOztBQUVoRTs7R0FFRztBQUNILENBQUMsVUFBVSxDQUFDLEVBQUU7RUFDWixNQUFNLENBQUMsU0FBUyxDQUFDLGVBQWUsR0FBRztBQUNyQyxJQUFJLE1BQU0sRUFBRSxTQUFTLE9BQU8sRUFBRSxRQUFRLEVBQUU7O01BRWxDLENBQUMsQ0FBQyxzQ0FBc0MsRUFBRSxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVztRQUNqRSxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQy9DLFFBQVEsSUFBSSxNQUFNLEdBQUcsUUFBUSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQzs7UUFFN0MsSUFBSSxlQUFlLEdBQUcsS0FB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LENBQUMsSUFBSSxFQUFFLENBQUM7QUFDaEIsR0FBRzs7RUFFRCxJQUFJLEVBQUUsV0FBVztJQUNmLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUNsQyxHQUFHOztFQUVELElBQUksRUFBRSxXQUFXO0lBQ2YsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0dBQ2hDO0NBQ0YsQ0FBQyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKipcbiAqIEBmaWxlXG4gKiBKYXZhc2NyaXB0IGZvciBBU1UgRGVwdCBQaWNrZXJcbiAqXG4gKiBSZXF1aXJlcyBSZWFjdC9SZWFjdERPTVxuICovXG52YXIgQXN1RGVwdFBpY2tlciA9IHJlcXVpcmUoJy4vY29tcG9uZW50cy9hc3UtZGVwdC1waWNrZXIuanN4Jyk7XG5cbi8qKlxuICogUHJvdmlkZXMgYW4gQVNVIGRlcGFydG1lbnQgcGlja2VyIHdpZGdldC5cbiAqL1xuKGZ1bmN0aW9uICgkKSB7XG4gIERydXBhbC5iZWhhdmlvcnMuYXN1X2RlcHRfcGlja2VyID0ge1xuICAgIGF0dGFjaDogZnVuY3Rpb24oY29udGV4dCwgc2V0dGluZ3MpIHtcbiAgICAgIC8vIHNldHVwIGFueSBhc3UtZGVwdC1waWNrZXIgZmllbGRzXG4gICAgICAkKCcuYXN1LWRlcHQtcGlja2VyOm5vdChbZGF0YS1yZWFjdGlkXSknLCBjb250ZXh0KS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZGVsdGEgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtZGVsdGEnKTtcbiAgICAgICAgdmFyIGNvbmZpZyA9IHNldHRpbmdzLmFzdV9kZXB0X3BpY2tlcltkZWx0YV07XG5cbiAgICAgICAgdmFyIGFzdV9kZXB0X3BpY2tlciA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoQXN1RGVwdFBpY2tlciwgY29uZmlnKTtcbiAgICAgICAgUmVhY3RET00ucmVuZGVyKGFzdV9kZXB0X3BpY2tlciwgdGhpcyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKGpRdWVyeSk7XG4iLCIvKipcbiAqIEFTVSBEZXBhcnRtZW50IFBpY2tlciBDb21wb25lbnRcbiAqL1xudmFyIERlcHRUcmVlID0gcmVxdWlyZSgnLi9kZXB0LXRyZWUnKTtcbnZhciBEZXB0TGlzdCA9IHJlcXVpcmUoJy4vZGVwdC1saXN0Jyk7XG52YXIgTW9kYWwgPSByZXF1aXJlKCcuL21vZGFsJyk7XG5cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNvbmZpZzoge2l0ZW1zOiBbXSwgb3B0aW9uczoge319LFxuICAgICAgc2VsZWN0ZWREZXBhcnRtZW50czogW10sXG4gICAgICBjdXJyZW50Tm9kZTogbnVsbCxcbiAgICAgIGluY2x1ZGVTdWJkZXB0czogZmFsc2VcbiAgICB9O1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwid2lkZ2V0LWFzdS1kZXB0LXBpY2tlclwiPlxuICAgICAge3RoaXMucmVuZGVyQnJvd3NlQnV0dG9uKCl9XG4gICAgICB7dGhpcy5yZW5kZXJEZXBhcnRtZW50TGlzdCgpfVxuICAgICAge3RoaXMucmVuZGVyTW9kYWwoKX1cbiAgICA8L2Rpdj5cbiAgfSxcblxuICByZW5kZXJNb2RhbDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGRlcHRUcmVlID0gPERlcHRUcmVlIFxuICAgICAgcmVmPVwiZGVwdFRyZWVcIiB7Li4udGhpcy5wcm9wc31cbiAgICAgIG9uVHJlZUNsaWNrPXt0aGlzLmhhbmRsZURlcHRUcmVlQ2xpY2t9XG4gICAgLz5cblxuICAgIHJldHVybiA8TW9kYWxcbiAgICAgIHJlZj1cIm1vZGFsXCJcbiAgICAgIHRpdGxlPVwiU2VsZWN0IERlcGFydG1lbnRcIlxuICAgICAgY29udGVudD17ZGVwdFRyZWV9XG4gICAgICBvblN1Y2Nlc3M9e3RoaXMuaGFuZGxlTW9kYWxTdWNjZXNzfVxuICAgICAgb25TdWJkZXB0Q2xpY2s9e3RoaXMuaGFuZGxlU3ViZGVwdENsaWNrfVxuICAgIC8+O1xuICB9LFxuXG4gIHJlbmRlckRlcGFydG1lbnRMaXN0OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gPERlcHRMaXN0XG4gICAgICByZWY9XCJkZXB0TGlzdFwiXG4gICAgICBvblJlbW92ZURlcHQ9e3RoaXMuaGFuZGxlUmVtb3ZlRGVwdH1cbiAgICAgIGl0ZW1zPXt0aGlzLnN0YXRlLnNlbGVjdGVkRGVwYXJ0bWVudHN9XG4gICAgLz5cbiAgfSxcblxuICByZW5kZXJCcm93c2VCdXR0b246IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImJyb3dzZS1idXR0b25cIj5cbiAgICAgIDxpbnB1dCB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgdmFsdWU9XCJCcm93c2VcIlxuICAgICAgICBjbGFzc05hbWU9XCJmb3JtLXN1Ym1pdFwiXG4gICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlQnJvd3NlQ2xpY2t9XG4gICAgICAvPlxuICAgIDwvZGl2PlxuICB9LFxuXG4gIGhhbmRsZVJlbW92ZURlcHQ6IGZ1bmN0aW9uKGRvb21lZCkge1xuICAgIHZhciBkZXB0X2lkID0gZG9vbWVkLnByb3BzLmlkO1xuICAgIHZhciBjb25maWcgPSB0aGlzLnN0YXRlLmNvbmZpZztcblxuICAgIGNvbmZpZy5pdGVtcyA9IGNvbmZpZy5pdGVtcy5maWx0ZXIoZnVuY3Rpb24oaXRlbSl7XG4gICAgICByZXR1cm4gKGRlcHRfaWQgIT0gaXRlbS5kZXB0X2lkKTtcbiAgICB9KTtcblxuICAgIGRlbGV0ZSBjb25maWcub3B0aW9uc1tkZXB0X2lkXTtcblxuICAgIHRoaXMuc2V0U3RhdGUoeyBjb25maWc6IGNvbmZpZyB9KTtcblxuICAgIHRoaXMuc2V0U2VsZWN0ZWREZXBhcnRtZW50cygpO1xuICB9LFxuXG4gIGhhbmRsZVN1YmRlcHRDbGljazogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGluY2x1ZGVTdWJkZXB0czogIXRoaXMuc3RhdGUuaW5jbHVkZVN1YmRlcHRzIH0pO1xuICB9LFxuXG4gIGhhbmRsZU1vZGFsU3VjY2VzczogZnVuY3Rpb24oKSB7XG4gICAgLy8gc2V0dXAgY29uZmlnXG4gICAgdGhpcy5zZXREZXB0Q29uZmlnKHRoaXMucmVmcy5kZXB0VHJlZS5zdGF0ZS5jdXJyZW50Tm9kZSk7XG5cbiAgICAvLyB1cGRhdGUgc2VsZWN0ZWQgZGVwYXJ0bWVudHMgbGlzdFxuICAgIHRoaXMuc2V0U2VsZWN0ZWREZXBhcnRtZW50cygpO1xuICB9LFxuXG4gIGhhbmRsZUJyb3dzZUNsaWNrOiBmdW5jdGlvbihldmVudCkge1xuICAgIHRoaXMucmVmcy5tb2RhbC5zaG93KCk7XG4gIH0sXG5cbiAgaGFuZGxlRGVwdFRyZWVDbGljazogZnVuY3Rpb24oZGF0YSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBjdXJyZW50Tm9kZTogZGF0YS5ub2RlIH0pO1xuICB9LFxuXG4gIHNldFNlbGVjdGVkRGVwYXJ0bWVudHM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBkZXB0VHJlZSA9IHRoaXMucmVmcy5kZXB0VHJlZTtcbiAgICB2YXIgY29uZmlnID0gdGhpcy5zdGF0ZS5jb25maWc7XG4gICAgdmFyIGRlcHRzID0gW107XG5cbiAgICBjb25maWcuaXRlbXMubWFwKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KXtcbiAgICAgIGRlcHRzLnB1c2goe1xuICAgICAgICBpZDogaXRlbS5kZXB0X2lkLFxuICAgICAgICB0aXRsZTogZGVwdFRyZWUuZ2V0RGVwdFBhdGgoaXRlbS50aWQpLFxuICAgICAgICBzdWJkZXB0czogY29uZmlnLm9wdGlvbnNbaXRlbS5kZXB0X2lkXS5zdWJkZXB0c1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnNldFN0YXRlKHsgc2VsZWN0ZWREZXBhcnRtZW50czogZGVwdHMgfSk7XG4gIH0sXG5cbiAgc2V0RGVwdENvbmZpZzogZnVuY3Rpb24oZGF0YSkge1xuICAgIC8vIGdldCB0aGUgdHJlZSBwYXRoIHRvIHNldCB0aGUgbGFiZWxcbiAgICB2YXIgY29uZmlnID0gdGhpcy5zdGF0ZS5jb25maWc7XG5cbiAgICB2YXIgdW5pcXVlID0gdHJ1ZTtcbiAgICBjb25maWcuaXRlbXMubWFwKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG4gICAgICBpZiAoaXRlbS5kZXB0X25pZCA9PSBkYXRhLmRlcHRfbmlkKSB7XG4gICAgICAgIHVuaXF1ZSA9IGZhbHNlO1xuICAgICAgICBjb25maWcub3B0aW9uc1tpdGVtLmRlcHRfaWRdLnN1YmRlcHRzID0gdGhpcy5zdGF0ZS5pbmNsdWRlU3ViZGVwdHM7XG4gICAgICB9XG4gICAgfS5iaW5kKHRoaXMpKTtcblxuICAgIGlmICh1bmlxdWUpIHtcbiAgICAgIGNvbmZpZy5pdGVtcy5wdXNoKHtcbiAgICAgICAgJ2RlcHRfaWQnOiBkYXRhLmRlcHRfaWQsXG4gICAgICAgICdkZXB0X25pZCc6IGRhdGEuZGVwdF9uaWQsXG4gICAgICAgICd0cmVlX25pZHMnOiBkYXRhLnRyZWVfbmlkcyxcbiAgICAgICAgJ3RpZCc6IGRhdGEudGlkXG4gICAgICB9KTtcblxuICAgICAgY29uZmlnLm9wdGlvbnNbZGF0YS5kZXB0X2lkXSA9IHtcbiAgICAgICAgc3ViZGVwdHM6IHRoaXMuc3RhdGUuaW5jbHVkZVN1YmRlcHRzXG4gICAgICB9O1xuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoeyBjb25maWc6IGNvbmZpZyB9KTtcbiAgfVxufSk7XG4iLCIvKipcbiAqIEFTVSBEZXBhcnRtZW50IExpc3QgSXRlbSBDb21wb25lbnRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIGhhbmRsZUl0ZW1SZW1vdmU6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdGhpcy5wcm9wcy5vblJlbW92ZURlcHQodGhpcyk7XG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gPGxpIHJlZj1cImRlcHRcIj5cbiAgICAgIHt0aGlzLnByb3BzLnRpdGxlfVxuICAgICAge3RoaXMucmVuZGVyU3ViZGVwdHNMYWJlbCgpfVxuICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGFnIHJlbW92ZVwiPlxuICAgICAgICA8c3BhblxuICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlSXRlbVJlbW92ZX1cbiAgICAgICAgICBjbGFzc05hbWU9XCJmYSBmYS1jbG9zZVwiIC8+XG4gICAgICA8L3NwYW4+XG4gICAgPC9saT5cbiAgfSxcblxuICByZW5kZXJTdWJkZXB0c0xhYmVsOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5wcm9wcy5zdWJkZXB0cykge1xuICAgICAgcmV0dXJuIDxzcGFuIGNsYXNzTmFtZT1cInRhZyBzdWJkZXB0c1wiPitzdWJkZXB0czwvc3Bhbj5cbiAgICB9XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBBU1UgRGVwYXJ0bWVudCBQaWNrZXIgQ29tcG9uZW50XG4gKi9cbnZhciBEZXB0TGlzdEl0ZW0gPSByZXF1aXJlKCcuL2RlcHQtbGlzdC1pdGVtJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiA8dWwgY2xhc3NOYW1lPVwiYXN1LWRlcHQtbGlzdFwiPlxuICAgICAge3RoaXMucmVuZGVyTGlzdCgpfVxuICAgIDwvdWw+XG4gIH0sXG5cbiAgcmVuZGVyTGlzdDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuaXRlbXMubWFwKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIHJldHVybiA8RGVwdExpc3RJdGVtXG4gICAgICAgIGtleT17aXRlbS5pZH1cbiAgICAgICAgb25SZW1vdmVEZXB0PXt0aGlzLnByb3BzLm9uUmVtb3ZlRGVwdH1cbiAgICAgICAgc3ViZGVwdHM9e2l0ZW0uc3ViZGVwdHN9XG4gICAgICAgIGlkPXtpdGVtLmlkfVxuICAgICAgICB0aXRsZT17aXRlbS50aXRsZX1cbiAgICAgIC8+XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfSxcbn0pO1xuIiwidmFyICQgPSBqUXVlcnk7XG5cbi8qKlxuICogRGVwYXJ0bWVudCBUcmVlIENvbXBvbmVudFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHJlZURhdGE6IEpTT04ucGFyc2UodGhpcy5wcm9wcy50cmVlX2pzb25fZGF0YSksXG4gICAgICBjdXJyZW50Tm9kZToge1xuICAgICAgICBkZXB0X2lkOiAxMjM0LFxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIC8vIGluaXRpYWxpemUgdHJlZSBwbHVnaW4uLi5cbiAgICB2YXIgZWwgPSB0aGlzLnJlZnMudHJlZVdpZGdldDtcbiAgICB2YXIgdHJlZV9kYXRhID0gdGhpcy5zdGF0ZS50cmVlRGF0YTtcbiAgICB2YXIgdG9wTGV2ZWwgPSAxMDtcblxuICAgIHZhciBkZWZhdWx0cyA9IHtcbiAgICAgIG9wZW5BdDogMSxcbiAgICAgIHNob3dPbmx5OiBudWxsLFxuICAgICAgYXV0b09wZW46IDBcbiAgICB9O1xuICAgIG9wdGlvbnMgPSAkLmV4dGVuZChkZWZhdWx0cywgdGhpcy5wcm9wcyk7XG5cbiAgICAkKGVsKS50cmVlKHtcbiAgICAgIGRhdGE6IHRyZWVfZGF0YSxcbiAgICAgIGNsb3NlZEljb246ICQoJzxzcGFuIGNsYXNzPVwiZmEgZmEtcGx1cy1jaXJjbGVcIj48L3NwYW4+JyksXG4gICAgICBvcGVuZWRJY29uOiAkKCc8c3BhbiBjbGFzcz1cImZhIGZhLW1pbnVzLWNpcmNsZVwiPjwvc3Bhbj4nKSxcblxuICAgICAgLy8gRmlyc3QgbGV2ZWwgb3BlblxuICAgICAgYXV0b09wZW46IG9wdGlvbnMuYXV0b09wZW4sXG4gICAgICBzZWxlY3RhYmxlOiB0cnVlLFxuXG4gICAgICAvLyBBc3NpZ24gZGVwdF9pZCBhdHRyaWJ1dGUgdG8gZWFjaCB0cmVlIDxsaT5cbiAgICAgIG9uQ3JlYXRlTGk6IGZ1bmN0aW9uIChub2RlLCAkbGkpIHtcbiAgICAgICAgJGxpLmF0dHIoJ2RlcHRfbmlkJywgbm9kZS5kZXB0X25pZCk7XG4gICAgICAgICRsaS5hdHRyKCdkZXB0X2lkJywgbm9kZS5kZXB0X2lkKTtcblxuICAgICAgICBpZiAob3B0aW9ucy5zaG93T25seSAmJiBBcnJheS5pc0FycmF5KG9wdGlvbnMuc2hvd09ubHkpICYmIG9wdGlvbnMuc2hvd09ubHkubGVuZ3RoKSB7XG4gICAgICAgICAgJChlbCkuYWRkQ2xhc3MoJ3RyaW1tZWQnKTtcblxuICAgICAgICAgICQuZWFjaChvcHRpb25zLnNob3dPbmx5LCBmdW5jdGlvbihpbmRleCwgaXRlbSl7XG4gICAgICAgICAgICBpZiAoaXRlbSA9PSBub2RlLmRlcHRfbmlkIHx8IG5vZGUuZGVwdF9pZCA9PSAnQVNVJykge1xuICAgICAgICAgICAgICAkbGkuYWRkQ2xhc3MoJ3Zpc2libGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghbm9kZS5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgJGxpLmZpbmQoJy5qcXRyZWUtZWxlbWVudCcpLnByZXBlbmQoJzxzcGFuIGNsYXNzPVwianF0cmVlLWZvbGRlci1pY29uIGZhIGZhLWJvb2ttYXJrXCI+PC9zcGFuPicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAkKGVsKS5iaW5kKCd0cmVlLmNsaWNrJywgdGhpcy5vblRyZWVDbGljayk7XG4gIH0sXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiYXN1LWRlcHQtdHJlZVwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0cmVlLXdyYXBwZXJcIiByZWY9XCJ0cmVlV2lkZ2V0XCI+VHJlZSB3aWRnZXQ8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgfSxcbiAgb25UcmVlQ2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgZXZlbnQubm9kZS50cmVlX25pZHMgPSB0aGlzLmdldFRyZWVJZHMoZXZlbnQubm9kZSk7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGN1cnJlbnROb2RlOiBldmVudC5ub2RlIH0pO1xuICAgIHRoaXMucHJvcHMub25UcmVlQ2xpY2soZXZlbnQpO1xuICB9LFxuICBnZXREZXB0UGF0aDogZnVuY3Rpb24oZGVwdF90aWQsIHBhdGgsIHJldmVyc2UpIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgIGNhc2UgMTogcGF0aCA9IFtdO1xuICAgICAgY2FzZSAyOiByZXZlcnNlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAoaXRlbSA9IHRoaXMuZmluZFJvb3REZXB0KGRlcHRfdGlkLCAndGlkJykpIHtcblxuICAgICAgdmFyIGNsYXNzTmFtZSA9IFsnZnJhZ21lbnQnXTtcblxuICAgICAgaWYgKGl0ZW0ucGFyZW50c1swXSA9PSAnMCcpIHtcbiAgICAgICAgLy8gYWJicmV2aWF0ZSBBcml6b25hIFN0YXRlIFVuaXZlcnNpdHlcbiAgICAgICAgaXRlbS5uYW1lID0gJ0FTVSc7XG4gICAgICAgIGNsYXNzTmFtZS5wdXNoKCdmaXJzdCcpO1xuICAgICAgfVxuICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4ubGVuZ3RoID09IDApIHtcbiAgICAgICAgY2xhc3NOYW1lLnB1c2goJ2xhc3QnKTtcbiAgICAgIH1cblxuICAgICAgcGF0aC5wdXNoKDxzcGFuIGtleT17ZGVwdF90aWR9IGNsYXNzTmFtZT17Y2xhc3NOYW1lLmpvaW4oJyAnKX0+e2l0ZW0ubmFtZX08L3NwYW4+KTtcbiAgICAgIGlmIChpdGVtLnBhcmVudHMubGVuZ3RoKSB7XG4gICAgICAgIHBhdGggPSB0aGlzLmdldERlcHRQYXRoKGl0ZW0ucGFyZW50c1swXSwgcGF0aCwgZmFsc2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChyZXZlcnNlKSB7XG4gICAgICBwYXRoID0gcGF0aC5yZXZlcnNlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhdGg7XG4gIH0sXG4gIGdldFRyZWVJZHM6IGZ1bmN0aW9uKHRyZWUsIHRyZWVfaWRzKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMSkge1xuICAgICAgdHJlZV9pZHMgPSBbXTtcbiAgICB9XG5cbiAgICB0cmVlX2lkcy5wdXNoKHRyZWUuZGVwdF9uaWQpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cmVlLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLmdldFRyZWVJZHModHJlZS5jaGlsZHJlbltpXSwgdHJlZV9pZHMpO1xuICAgIH1cblxuICAgIHJldHVybiB0cmVlX2lkcztcbiAgfSxcbiAgZmluZFJvb3REZXB0OiBmdW5jdGlvbihkZXB0X2lkLCBpZF90eXBlLCBkYXRhKSB7XG4gICAgdmFyIGRlcHQgPSBudWxsO1xuXG4gICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgaWRfdHlwZSA9ICdkZXB0X25pZCc7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIGRhdGEgPSB0aGlzLnN0YXRlLnRyZWVEYXRhO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAxKSB7XG4gICAgICBpZF90eXBlID0gJ2RlcHRfbmlkJztcbiAgICB9XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChkZXB0ID09IG51bGwgJiYgZGF0YVtpXSAhPSBudWxsKSB7XG4gICAgICAgIGlmIChkYXRhW2ldW2lkX3R5cGVdID09IGRlcHRfaWQpIHtcbiAgICAgICAgICByZXR1cm4gZGF0YVtpXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkYXRhW2ldLmhhc093blByb3BlcnR5KCdjaGlsZHJlbicpKSB7XG4gICAgICAgICAgZGVwdCA9IHRoaXMuZmluZFJvb3REZXB0KGRlcHRfaWQsIGlkX3R5cGUsIGRhdGFbaV0uY2hpbGRyZW4pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBkZXB0O1xuICB9XG59KTtcbiIsIi8qKlxuICogRGVwYXJ0bWVudCBUcmVlIENvbXBvbmVudFxuICovXG52YXIgRGVwdFRyZWUgPSByZXF1aXJlKCcuL2RlcHQtdHJlZScpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKGUua2V5Q29kZSA9PSAyNykge1xuICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgIH1cbiAgICB9LmJpbmQodGhpcykpO1xuICB9LFxuXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG9wZW46IGZhbHNlXG4gICAgfVxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cbiAgICB2YXIgbW9kYWxDbGFzcyA9ICh0aGlzLnN0YXRlLm9wZW4gPyAnZGlhbG9nLW9wZW4nIDogJycpO1xuXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXtcImFzdS1kZXB0LXBpY2tlci1tb2RhbCBcIiArIG1vZGFsQ2xhc3N9PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJkaWFsb2dcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkaWFsb2ctdGl0bGVcIj5cbiAgICAgICAgICB7dGhpcy5wcm9wcy50aXRsZX1cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNsb3NlLWRpYWxvZ1wiIG9uQ2xpY2s9e3RoaXMuaGFuZGxlQ2FuY2VsQ2xpY2t9PlxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZmEgZmEtY2xvc2VcIj48L3NwYW4+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICB7dGhpcy5wcm9wcy5jb250ZW50fVxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFjdGlvbnNcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0taXRlbSBmb3JtLXR5cGUtY2hlY2tib3hcIj5cbiAgICAgICAgICAgIDxpbnB1dCBcbiAgICAgICAgICAgICAgcmVmPVwiaW5jbHVkZV9zdWJkZXB0XCJcbiAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZm9ybS1jaGVja2JveFwiXG4gICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlU3ViZGVwdENsaWNrfVxuICAgICAgICAgICAgICBkZWZhdWx0Q2hlY2tlZD17dGhpcy5zdGF0ZS5pbmNsdWRlU3ViZGVwdHMgPyAnY2hlY2tlZCcgOiAnJ31cbiAgICAgICAgICAgIC8+IFxuICAgICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cIm9wdGlvblwiIG9uQ2xpY2s9e3RoaXMuaGFuZGxlTGFiZWxDbGlja30+IEluY2x1ZGUgc3ViLWRlcGFydG1lbnRzPzwvbGFiZWw+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRlc2NyaXB0aW9uXCIgc3R5bGU9e3snZGlzcGxheSc6ICdub25lJ319PlxuICAgICAgICAgICAgICBUaGlzIHdpbGwgaW5jbHVkZSBhbGwgc3ViLWRlcGFydG1lbnRzIGJlbmVhdGggdGhlIHNlbGVjdGVkIGRlcGFydG1lbnQuXG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8aW5wdXQgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJmb3JtLXN1Ym1pdFwiXG4gICAgICAgICAgICBvbkNsaWNrPXt0aGlzLmhhbmRsZVN1Ym1pdENsaWNrfVxuICAgICAgICAgICAgdmFsdWU9XCJTdWJtaXRcIlxuICAgICAgICAgIC8+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiZm9ybS1zdWJtaXRcIlxuICAgICAgICAgICAgb25DbGljaz17dGhpcy5oYW5kbGVDYW5jZWxDbGlja31cbiAgICAgICAgICAgIHZhbHVlPVwiQ2FuY2VsXCJcbiAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9LFxuXG4gIGhhbmRsZVN1YmRlcHRDbGljazogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMucHJvcHMub25TdWJkZXB0Q2xpY2spIHtcbiAgICAgIHRoaXMucHJvcHMub25TdWJkZXB0Q2xpY2soKTtcbiAgICB9XG4gIH0sXG5cbiAgaGFuZGxlTGFiZWxDbGljazogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5yZWZzLmluY2x1ZGVfc3ViZGVwdC5jbGljaygpO1xuICB9LFxuXG4gIGhhbmRsZUNhbmNlbENsaWNrOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5wcm9wcy5vbkNhbmNlbENsaWNrKSB7XG4gICAgICB0aGlzLnByb3BzLm9uQ2FuY2VsQ2xpY2soKTtcbiAgICB9XG5cbiAgICB0aGlzLmhpZGUoKTtcbiAgfSxcblxuICBoYW5kbGVTdWJtaXRDbGljazogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMucHJvcHMub25TdWNjZXNzKSB7XG4gICAgICB0aGlzLnByb3BzLm9uU3VjY2VzcygpO1xuICAgIH1cblxuICAgIHRoaXMuaGlkZSgpO1xuICB9LFxuXG4gIHNob3c6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBvcGVuOiB0cnVlIH0pO1xuICB9LFxuXG4gIGhpZGU6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBvcGVuOiBmYWxzZSB9KTtcbiAgfVxufSk7Il19
