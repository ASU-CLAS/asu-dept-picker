(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * @file
 * Javascript for ASU Dept Picker
 *
 * Requires React/ReactDOM
 */
AsuDeptPicker = require('./components/asu-dept-picker.jsx');


},{"./components/asu-dept-picker.jsx":2}],2:[function(require,module,exports){
/**
 * ASU Department Picker Component
 */
var DeptTree = require('./dept-tree');
var DeptList = require('./dept-list');
var Modal = require('./modal');


module.exports = React.createClass({displayName: "exports",

  componentDidMount: function() {
    this.setSelectedDepartments();
  },

  getInitialState: function() {
    var default_config = {
      items: this.props.items || [],
      options: this.props.options || {}
    }

    return {
      config: default_config,
      selectedDepartments: [],
      currentNode: null,
      includeSubdepts: false
    };
  },

  render: function() {
    return React.createElement("div", {className: "widget-asu-dept-picker"}, 
      this.renderBrowseButton(), 
      this.renderDepartmentList(), 
      this.renderModal()
    )
  },

  renderModal: function() {
    var deptTree = React.createElement(DeptTree, {
      ref: "deptTree", 
      treeData: this.props.tree_json_data, 
      onTreeSelect: this.handleDeptTreeSelect}
    )

    return React.createElement(Modal, {
      ref: "modal", 
      title: "Select Department", 
      content: deptTree, 
      onSuccess: this.handleModalSuccess, 
      onSubdeptClick: this.handleSubdeptClick}
    );
  },

  renderDepartmentList: function() {
    return React.createElement(DeptList, {
      ref: "deptList", 
      onRemoveDept: this.handleRemoveDept, 
      items: this.state.selectedDepartments}
    )
  },

  renderBrowseButton: function() {
    return React.createElement("div", {className: "browse-button"}, 
      React.createElement("input", {type: "button", 
        value: "Browse", 
        className: "form-submit", 
        onClick: this.handleBrowseClick}
      )
    )
  },

  handleRemoveDept: function(doomed) {
    var dept_id = doomed.props.id;
    var config = this.state.config;

    config.items = config.items.filter(function(item){
      return (dept_id != item.dept_id);
    });

    delete config.options[dept_id];

    this.setState({ config: config });
    this.setSelectedDepartments();
  },

  handleSubdeptClick: function() {
    this.setState({ includeSubdepts: !this.state.includeSubdepts });
  },

  handleModalSuccess: function() {
    if (this.state.currentNode) {
      // setup config
      this.setDeptConfig(this.state.currentNode);

      // update selected departments list
      this.setSelectedDepartments();
    }
  },

  handleBrowseClick: function(event) {
    this.refs.modal.show();
  },

  handleDeptTreeSelect: function(data) {
    this.setState({ currentNode: data.node });
  },

  setSelectedDepartments: function() {
    var deptTree = this.refs.deptTree;
    var config = this.state.config;
    var depts = [];

    config.items.map(function(item, index){
      depts.push({
        id: item.dept_id,
        title: deptTree.getDeptPath(item.tid),
        subdepts: config.options[item.dept_id].subdepts
      });
    });

    this.setState({ selectedDepartments: depts });
    this.triggerChange();
  },

  setDeptConfig: function(data) {
    // get the tree path to set the label
    var config = this.state.config;

    var unique = true;
    config.items.map(function(item, index) {
      if (item.dept_nid == data.dept_nid) {
        unique = false;
        config.options[item.dept_id].subdepts = this.state.includeSubdepts;
      }
    }.bind(this));

    if (unique) {
      config.items.push({
        'dept_id': data.dept_id,
        'dept_nid': data.dept_nid,
        'tree_nids': data.tree_nids,
        'tid': data.tid
      });

      config.options[data.dept_id] = {
        subdepts: this.state.includeSubdepts
      };
    }

    this.setState({ config: config });
  },

  triggerChange: function() {
    if (this.props.onChange) {
      this.props.onChange(this.state.config);
    }
  }
});


},{"./dept-list":4,"./dept-tree":5,"./modal":6}],3:[function(require,module,exports){
/**
 * ASU Department List Item Component
 */
module.exports = React.createClass({displayName: "exports",
  handleItemRemove: function(event) {
    this.props.onRemoveDept(this);
  },

  render: function() {
    return React.createElement("li", {ref: "dept"}, 
      this.props.title, 
      this.renderSubdeptsLabel(), 
      React.createElement("span", {className: "tag remove"}, 
        React.createElement("span", {
          onClick: this.handleItemRemove, 
          className: "fa fa-close"})
      )
    )
  },

  renderSubdeptsLabel: function() {
    if (this.props.subdepts) {
      return React.createElement("span", {className: "tag subdepts"}, "+subdepts")
    }
  }
});


},{}],4:[function(require,module,exports){
/**
 * ASU Department Picker Component
 */
var DeptListItem = require('./dept-list-item');

module.exports = React.createClass({displayName: "exports",
  render: function() {
    return React.createElement("ul", {className: "asu-dept-list"}, 
      this.renderList()
    )
  },

  renderList: function() {

    if (this.props.items.length == 0) {
      return React.createElement("li", null, React.createElement("span", {className: "list-no-items"}, "Click browse to add department(s)"));
    }

    return this.props.items.map(function(item) {
      return React.createElement(DeptListItem, {
        key: item.id, 
        onRemoveDept: this.props.onRemoveDept, 
        subdepts: item.subdepts, 
        id: item.id, 
        title: item.title}
      )
    }.bind(this));
  },
});


},{"./dept-list-item":3}],5:[function(require,module,exports){
var $ = jQuery;

/**
 * Department Tree Component
 */
module.exports = React.createClass({displayName: "exports",
  getInitialState: function() {
    return {
      treeData: JSON.parse(this.props.treeData),
      currentNode: null
    }
  },

  componentDidMount: function() {
    // initialize tree plugin...
    var el = this.refs.treeContainer;
    var tree_data = this.state.treeData;
    var topLevel = 10;

    var defaults = {
      openAt: 1,
      showOnly: null,
      autoOpen: 0,
      selectable: true
    };
    var options = $.extend(defaults, this.props);

    $(el).tree({
      data: tree_data,
      closedIcon: $('<span class="fa fa-plus-circle"></span>'),
      openedIcon: $('<span class="fa fa-minus-circle"></span>'),

      // First level open
      autoOpen: options.autoOpen,
      selectable: options.selectable,

      // Assign dept_id attribute to each tree <li>
      onCreateLi: function (node, $li) {
        $li.attr('dept_nid', node.dept_nid);
        $li.attr('dept_id', node.dept_id);

        if (options.showOnly && Array.isArray(options.showOnly) && options.showOnly.length) {
          $(el).addClass('trimmed');

          $.each(options.showOnly, function(index, item){
            if (item == node.dept_nid || node.dept_id == 'ASU') {
              $li.addClass('visible');
            }
          });
        }

        if (!node.hasChildren()) {
          $li.find('.jqtree-element').prepend('<span class="jqtree-folder-icon fa fa-bookmark"></span>');
        }
      }
    });

    $(el).bind('tree.select', this.onTreeSelect);
  },

  render: function() {
    return React.createElement("div", {className: "asu-dept-tree"}, 
      React.createElement("div", {className: "tree-container", ref: "treeContainer"})
    )
  },

  onTreeSelect: function(event) {
    if (event.node) {
      event.node.tree_nids = this.getTreeIds(event.node);
    }

    this.setState({ currentNode: event.node });
    this.props.onTreeSelect(event);
  },

  getDeptPath: function(dept_tid, path, reverse) {
    switch (arguments.length) {
      case 1: path = [];
      case 2: reverse = true;
    }

    if (item = this.findRootDept(dept_tid, 'tid')) {

      var className = ['fragment'];

      if (item.parents[0] == '0') {
        // abbreviate Arizona State University
        item.name = 'ASU';
        className.push('first');
      }
      if (item.children.length == 0) {
        className.push('last');
      }

      path.push(React.createElement("span", {key: dept_tid, className: className.join(' ')}, item.name));
      if (item.parents.length) {
        path = this.getDeptPath(item.parents[0], path, false);
      }
    }

    if (reverse) {
      path = path.reverse();
    }

    return path;
  },

  getTreeIds: function(tree, tree_ids) {
    if (arguments.length == 1) {
      tree_ids = [];
    }

    tree_ids.push(tree.dept_nid);

    for (var i = 0; i < tree.children.length; i++) {
      this.getTreeIds(tree.children[i], tree_ids);
    }

    return tree_ids;
  },

  findRootDept: function(dept_id, id_type, data) {
    var dept = null;

    switch(arguments.length) {
      case 1:
        id_type = 'dept_nid';
      case 2:
        data = this.state.treeData;
        break;
    }

    if (arguments.length == 1) {
      id_type = 'dept_nid';
    }

    for (var i = 0; i < data.length; i++) {
      if (dept == null && data[i] != null) {
        if (data[i][id_type] == dept_id) {
          return data[i];
        }
        else if (data[i].hasOwnProperty('children')) {
          dept = this.findRootDept(dept_id, id_type, data[i].children);
        }
      }
      else {
        break;
      }
    }
    return dept;
  }
});


},{}],6:[function(require,module,exports){
/**
 * Department Tree Component
 */
var DeptTree = require('./dept-tree');

module.exports = React.createClass({displayName: "exports",
  componentDidMount: function() {
    document.addEventListener('keyup', function(e) {
      if (e.keyCode == 27) {
        this.hide();
      }
    }.bind(this));
  },

  getInitialState: function() {
    return {
      open: false
    }
  },

  render: function() {

    var modalClass = (this.state.open ? 'dialog-open' : '');

    return React.createElement("div", {className: "asu-dept-picker-modal " + modalClass}, 
      React.createElement("div", {className: "dialog"}, 
        React.createElement("div", {className: "dialog-title"}, 
          this.props.title, 
          React.createElement("div", {className: "close-dialog", onClick: this.handleCancelClick}, 
            React.createElement("span", {className: "fa fa-close"})
          )
        ), 
        this.props.content, 
        React.createElement("div", {className: "actions"}, 
          React.createElement("div", {className: "form-item form-type-checkbox"}, 
            React.createElement("input", {
              ref: "include_subdept", 
              type: "checkbox", 
              className: "form-checkbox", 
              onClick: this.handleSubdeptClick, 
              defaultChecked: this.state.includeSubdepts ? 'checked' : ''}
            ), 
            React.createElement("label", {className: "option", onClick: this.handleLabelClick}, " Include sub-departments?"), 
            React.createElement("div", {className: "description", style: {'display': 'none'}}, 
              "This will include all sub-departments beneath the selected department."
            )
          ), 
          React.createElement("input", {type: "button", 
            className: "form-submit", 
            onClick: this.handleSubmitClick, 
            value: "Submit"}
          ), 
          React.createElement("input", {type: "button", 
            className: "form-submit", 
            onClick: this.handleCancelClick, 
            value: "Cancel"}
          )
        )
      )
    )
  },

  handleSubdeptClick: function() {
    if (this.props.onSubdeptClick) {
      this.props.onSubdeptClick();
    }
  },

  handleLabelClick: function() {
    this.refs.include_subdept.click();
  },

  handleCancelClick: function() {
    if (this.props.onCancelClick) {
      this.props.onCancelClick();
    }

    this.hide();
  },

  handleSubmitClick: function() {
    if (this.props.onSuccess) {
      this.props.onSuccess();
    }

    this.hide();
  },

  show: function() {
    this.setState({ open: true });
  },

  hide: function() {
    this.setState({ open: false });
  }
});

},{"./dept-tree":5}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvc2ViYXN0aWFuL3d3dy9hc3VfZGVwdF9waWNrZXIvc3JjL21haW4uanN4IiwiL1VzZXJzL3NlYmFzdGlhbi93d3cvYXN1X2RlcHRfcGlja2VyL3NyYy9jb21wb25lbnRzL2FzdS1kZXB0LXBpY2tlci5qc3giLCIvVXNlcnMvc2ViYXN0aWFuL3d3dy9hc3VfZGVwdF9waWNrZXIvc3JjL2NvbXBvbmVudHMvZGVwdC1saXN0LWl0ZW0uanN4IiwiL1VzZXJzL3NlYmFzdGlhbi93d3cvYXN1X2RlcHRfcGlja2VyL3NyYy9jb21wb25lbnRzL2RlcHQtbGlzdC5qc3giLCIvVXNlcnMvc2ViYXN0aWFuL3d3dy9hc3VfZGVwdF9waWNrZXIvc3JjL2NvbXBvbmVudHMvZGVwdC10cmVlLmpzeCIsIi9Vc2Vycy9zZWJhc3RpYW4vd3d3L2FzdV9kZXB0X3BpY2tlci9zcmMvY29tcG9uZW50cy9tb2RhbC5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTs7R0FFRztBQUNILGFBQWEsR0FBRyxPQUFPLENBQUMsa0NBQWtDLENBQUMsQ0FBQzs7OztBQ041RDs7R0FFRztBQUNILElBQUksUUFBUSxHQUFHLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQztBQUN0QyxJQUFJLFFBQVEsR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDdEMsSUFBSSxLQUFLLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQy9COztBQUVBLG9DQUFvQyx1QkFBQTs7RUFFbEMsaUJBQWlCLEVBQUUsV0FBVztJQUM1QixJQUFJLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztBQUNsQyxHQUFHOztFQUVELGVBQWUsRUFBRSxXQUFXO0lBQzFCLElBQUksY0FBYyxHQUFHO01BQ25CLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssSUFBSSxFQUFFO01B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O0lBRUQsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0FBQ2hCLEdBQUc7O0VBRUQsaUJBQWlCLEVBQUUsV0FBVztJQUM1QixJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxFQUFFO01BQ3hCLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxFQUFFLENBQUM7QUFDN0IsS0FBSzs7SUFFRCxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDaEIsR0FBRzs7RUFFRCxJQUFJLEVBQUUsV0FBVztJQUNmLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUNsQyxHQUFHOztFQUVELElBQUksRUFBRSxXQUFXO0lBQ2YsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0dBQ2hDO0NBQ0YsQ0FBQyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKipcbiAqIEBmaWxlXG4gKiBKYXZhc2NyaXB0IGZvciBBU1UgRGVwdCBQaWNrZXJcbiAqXG4gKiBSZXF1aXJlcyBSZWFjdC9SZWFjdERPTVxuICovXG5Bc3VEZXB0UGlja2VyID0gcmVxdWlyZSgnLi9jb21wb25lbnRzL2FzdS1kZXB0LXBpY2tlci5qc3gnKTtcbiIsIi8qKlxuICogQVNVIERlcGFydG1lbnQgUGlja2VyIENvbXBvbmVudFxuICovXG52YXIgRGVwdFRyZWUgPSByZXF1aXJlKCcuL2RlcHQtdHJlZScpO1xudmFyIERlcHRMaXN0ID0gcmVxdWlyZSgnLi9kZXB0LWxpc3QnKTtcbnZhciBNb2RhbCA9IHJlcXVpcmUoJy4vbW9kYWwnKTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zZXRTZWxlY3RlZERlcGFydG1lbnRzKCk7XG4gIH0sXG5cbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgZGVmYXVsdF9jb25maWcgPSB7XG4gICAgICBpdGVtczogdGhpcy5wcm9wcy5pdGVtcyB8fCBbXSxcbiAgICAgIG9wdGlvbnM6IHRoaXMucHJvcHMub3B0aW9ucyB8fCB7fVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBjb25maWc6IGRlZmF1bHRfY29uZmlnLFxuICAgICAgc2VsZWN0ZWREZXBhcnRtZW50czogW10sXG4gICAgICBjdXJyZW50Tm9kZTogbnVsbCxcbiAgICAgIGluY2x1ZGVTdWJkZXB0czogZmFsc2VcbiAgICB9O1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwid2lkZ2V0LWFzdS1kZXB0LXBpY2tlclwiPlxuICAgICAge3RoaXMucmVuZGVyQnJvd3NlQnV0dG9uKCl9XG4gICAgICB7dGhpcy5yZW5kZXJEZXBhcnRtZW50TGlzdCgpfVxuICAgICAge3RoaXMucmVuZGVyTW9kYWwoKX1cbiAgICA8L2Rpdj5cbiAgfSxcblxuICByZW5kZXJNb2RhbDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGRlcHRUcmVlID0gPERlcHRUcmVlIFxuICAgICAgcmVmPVwiZGVwdFRyZWVcIlxuICAgICAgdHJlZURhdGE9e3RoaXMucHJvcHMudHJlZV9qc29uX2RhdGF9XG4gICAgICBvblRyZWVTZWxlY3Q9e3RoaXMuaGFuZGxlRGVwdFRyZWVTZWxlY3R9XG4gICAgLz5cblxuICAgIHJldHVybiA8TW9kYWxcbiAgICAgIHJlZj1cIm1vZGFsXCJcbiAgICAgIHRpdGxlPVwiU2VsZWN0IERlcGFydG1lbnRcIlxuICAgICAgY29udGVudD17ZGVwdFRyZWV9XG4gICAgICBvblN1Y2Nlc3M9e3RoaXMuaGFuZGxlTW9kYWxTdWNjZXNzfVxuICAgICAgb25TdWJkZXB0Q2xpY2s9e3RoaXMuaGFuZGxlU3ViZGVwdENsaWNrfVxuICAgIC8+O1xuICB9LFxuXG4gIHJlbmRlckRlcGFydG1lbnRMaXN0OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gPERlcHRMaXN0XG4gICAgICByZWY9XCJkZXB0TGlzdFwiXG4gICAgICBvblJlbW92ZURlcHQ9e3RoaXMuaGFuZGxlUmVtb3ZlRGVwdH1cbiAgICAgIGl0ZW1zPXt0aGlzLnN0YXRlLnNlbGVjdGVkRGVwYXJ0bWVudHN9XG4gICAgLz5cbiAgfSxcblxuICByZW5kZXJCcm93c2VCdXR0b246IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImJyb3dzZS1idXR0b25cIj5cbiAgICAgIDxpbnB1dCB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgdmFsdWU9XCJCcm93c2VcIlxuICAgICAgICBjbGFzc05hbWU9XCJmb3JtLXN1Ym1pdFwiXG4gICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlQnJvd3NlQ2xpY2t9XG4gICAgICAvPlxuICAgIDwvZGl2PlxuICB9LFxuXG4gIGhhbmRsZVJlbW92ZURlcHQ6IGZ1bmN0aW9uKGRvb21lZCkge1xuICAgIHZhciBkZXB0X2lkID0gZG9vbWVkLnByb3BzLmlkO1xuICAgIHZhciBjb25maWcgPSB0aGlzLnN0YXRlLmNvbmZpZztcblxuICAgIGNvbmZpZy5pdGVtcyA9IGNvbmZpZy5pdGVtcy5maWx0ZXIoZnVuY3Rpb24oaXRlbSl7XG4gICAgICByZXR1cm4gKGRlcHRfaWQgIT0gaXRlbS5kZXB0X2lkKTtcbiAgICB9KTtcblxuICAgIGRlbGV0ZSBjb25maWcub3B0aW9uc1tkZXB0X2lkXTtcblxuICAgIHRoaXMuc2V0U3RhdGUoeyBjb25maWc6IGNvbmZpZyB9KTtcbiAgICB0aGlzLnNldFNlbGVjdGVkRGVwYXJ0bWVudHMoKTtcbiAgfSxcblxuICBoYW5kbGVTdWJkZXB0Q2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBpbmNsdWRlU3ViZGVwdHM6ICF0aGlzLnN0YXRlLmluY2x1ZGVTdWJkZXB0cyB9KTtcbiAgfSxcblxuICBoYW5kbGVNb2RhbFN1Y2Nlc3M6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLnN0YXRlLmN1cnJlbnROb2RlKSB7XG4gICAgICAvLyBzZXR1cCBjb25maWdcbiAgICAgIHRoaXMuc2V0RGVwdENvbmZpZyh0aGlzLnN0YXRlLmN1cnJlbnROb2RlKTtcblxuICAgICAgLy8gdXBkYXRlIHNlbGVjdGVkIGRlcGFydG1lbnRzIGxpc3RcbiAgICAgIHRoaXMuc2V0U2VsZWN0ZWREZXBhcnRtZW50cygpO1xuICAgIH1cbiAgfSxcblxuICBoYW5kbGVCcm93c2VDbGljazogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB0aGlzLnJlZnMubW9kYWwuc2hvdygpO1xuICB9LFxuXG4gIGhhbmRsZURlcHRUcmVlU2VsZWN0OiBmdW5jdGlvbihkYXRhKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGN1cnJlbnROb2RlOiBkYXRhLm5vZGUgfSk7XG4gIH0sXG5cbiAgc2V0U2VsZWN0ZWREZXBhcnRtZW50czogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGRlcHRUcmVlID0gdGhpcy5yZWZzLmRlcHRUcmVlO1xuICAgIHZhciBjb25maWcgPSB0aGlzLnN0YXRlLmNvbmZpZztcbiAgICB2YXIgZGVwdHMgPSBbXTtcblxuICAgIGNvbmZpZy5pdGVtcy5tYXAoZnVuY3Rpb24oaXRlbSwgaW5kZXgpe1xuICAgICAgZGVwdHMucHVzaCh7XG4gICAgICAgIGlkOiBpdGVtLmRlcHRfaWQsXG4gICAgICAgIHRpdGxlOiBkZXB0VHJlZS5nZXREZXB0UGF0aChpdGVtLnRpZCksXG4gICAgICAgIHN1YmRlcHRzOiBjb25maWcub3B0aW9uc1tpdGVtLmRlcHRfaWRdLnN1YmRlcHRzXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRoaXMuc2V0U3RhdGUoeyBzZWxlY3RlZERlcGFydG1lbnRzOiBkZXB0cyB9KTtcbiAgICB0aGlzLnRyaWdnZXJDaGFuZ2UoKTtcbiAgfSxcblxuICBzZXREZXB0Q29uZmlnOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgLy8gZ2V0IHRoZSB0cmVlIHBhdGggdG8gc2V0IHRoZSBsYWJlbFxuICAgIHZhciBjb25maWcgPSB0aGlzLnN0YXRlLmNvbmZpZztcblxuICAgIHZhciB1bmlxdWUgPSB0cnVlO1xuICAgIGNvbmZpZy5pdGVtcy5tYXAoZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcbiAgICAgIGlmIChpdGVtLmRlcHRfbmlkID09IGRhdGEuZGVwdF9uaWQpIHtcbiAgICAgICAgdW5pcXVlID0gZmFsc2U7XG4gICAgICAgIGNvbmZpZy5vcHRpb25zW2l0ZW0uZGVwdF9pZF0uc3ViZGVwdHMgPSB0aGlzLnN0YXRlLmluY2x1ZGVTdWJkZXB0cztcbiAgICAgIH1cbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgaWYgKHVuaXF1ZSkge1xuICAgICAgY29uZmlnLml0ZW1zLnB1c2goe1xuICAgICAgICAnZGVwdF9pZCc6IGRhdGEuZGVwdF9pZCxcbiAgICAgICAgJ2RlcHRfbmlkJzogZGF0YS5kZXB0X25pZCxcbiAgICAgICAgJ3RyZWVfbmlkcyc6IGRhdGEudHJlZV9uaWRzLFxuICAgICAgICAndGlkJzogZGF0YS50aWRcbiAgICAgIH0pO1xuXG4gICAgICBjb25maWcub3B0aW9uc1tkYXRhLmRlcHRfaWRdID0ge1xuICAgICAgICBzdWJkZXB0czogdGhpcy5zdGF0ZS5pbmNsdWRlU3ViZGVwdHNcbiAgICAgIH07XG4gICAgfVxuXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGNvbmZpZzogY29uZmlnIH0pO1xuICB9LFxuXG4gIHRyaWdnZXJDaGFuZ2U6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLnByb3BzLm9uQ2hhbmdlKSB7XG4gICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKHRoaXMuc3RhdGUuY29uZmlnKTtcbiAgICB9XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBBU1UgRGVwYXJ0bWVudCBMaXN0IEl0ZW0gQ29tcG9uZW50XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICBoYW5kbGVJdGVtUmVtb3ZlOiBmdW5jdGlvbihldmVudCkge1xuICAgIHRoaXMucHJvcHMub25SZW1vdmVEZXB0KHRoaXMpO1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIDxsaSByZWY9XCJkZXB0XCI+XG4gICAgICB7dGhpcy5wcm9wcy50aXRsZX1cbiAgICAgIHt0aGlzLnJlbmRlclN1YmRlcHRzTGFiZWwoKX1cbiAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRhZyByZW1vdmVcIj5cbiAgICAgICAgPHNwYW5cbiAgICAgICAgICBvbkNsaWNrPXt0aGlzLmhhbmRsZUl0ZW1SZW1vdmV9XG4gICAgICAgICAgY2xhc3NOYW1lPVwiZmEgZmEtY2xvc2VcIiAvPlxuICAgICAgPC9zcGFuPlxuICAgIDwvbGk+XG4gIH0sXG5cbiAgcmVuZGVyU3ViZGVwdHNMYWJlbDogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMucHJvcHMuc3ViZGVwdHMpIHtcbiAgICAgIHJldHVybiA8c3BhbiBjbGFzc05hbWU9XCJ0YWcgc3ViZGVwdHNcIj4rc3ViZGVwdHM8L3NwYW4+XG4gICAgfVxuICB9XG59KTtcbiIsIi8qKlxuICogQVNVIERlcGFydG1lbnQgUGlja2VyIENvbXBvbmVudFxuICovXG52YXIgRGVwdExpc3RJdGVtID0gcmVxdWlyZSgnLi9kZXB0LWxpc3QtaXRlbScpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gPHVsIGNsYXNzTmFtZT1cImFzdS1kZXB0LWxpc3RcIj5cbiAgICAgIHt0aGlzLnJlbmRlckxpc3QoKX1cbiAgICA8L3VsPlxuICB9LFxuXG4gIHJlbmRlckxpc3Q6IGZ1bmN0aW9uKCkge1xuXG4gICAgaWYgKHRoaXMucHJvcHMuaXRlbXMubGVuZ3RoID09IDApIHtcbiAgICAgIHJldHVybiA8bGk+PHNwYW4gY2xhc3NOYW1lPVwibGlzdC1uby1pdGVtc1wiPkNsaWNrIGJyb3dzZSB0byBhZGQgZGVwYXJ0bWVudChzKTwvc3Bhbj48L2xpPjtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5wcm9wcy5pdGVtcy5tYXAoZnVuY3Rpb24oaXRlbSkge1xuICAgICAgcmV0dXJuIDxEZXB0TGlzdEl0ZW1cbiAgICAgICAga2V5PXtpdGVtLmlkfVxuICAgICAgICBvblJlbW92ZURlcHQ9e3RoaXMucHJvcHMub25SZW1vdmVEZXB0fVxuICAgICAgICBzdWJkZXB0cz17aXRlbS5zdWJkZXB0c31cbiAgICAgICAgaWQ9e2l0ZW0uaWR9XG4gICAgICAgIHRpdGxlPXtpdGVtLnRpdGxlfVxuICAgICAgLz5cbiAgICB9LmJpbmQodGhpcykpO1xuICB9LFxufSk7XG4iLCJ2YXIgJCA9IGpRdWVyeTtcblxuLyoqXG4gKiBEZXBhcnRtZW50IFRyZWUgQ29tcG9uZW50XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICB0cmVlRGF0YTogSlNPTi5wYXJzZSh0aGlzLnByb3BzLnRyZWVEYXRhKSxcbiAgICAgIGN1cnJlbnROb2RlOiBudWxsXG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgICAvLyBpbml0aWFsaXplIHRyZWUgcGx1Z2luLi4uXG4gICAgdmFyIGVsID0gdGhpcy5yZWZzLnRyZWVDb250YWluZXI7XG4gICAgdmFyIHRyZWVfZGF0YSA9IHRoaXMuc3RhdGUudHJlZURhdGE7XG4gICAgdmFyIHRvcExldmVsID0gMTA7XG5cbiAgICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgICBvcGVuQXQ6IDEsXG4gICAgICBzaG93T25seTogbnVsbCxcbiAgICAgIGF1dG9PcGVuOiAwLFxuICAgICAgc2VsZWN0YWJsZTogdHJ1ZVxuICAgIH07XG4gICAgdmFyIG9wdGlvbnMgPSAkLmV4dGVuZChkZWZhdWx0cywgdGhpcy5wcm9wcyk7XG5cbiAgICAkKGVsKS50cmVlKHtcbiAgICAgIGRhdGE6IHRyZWVfZGF0YSxcbiAgICAgIGNsb3NlZEljb246ICQoJzxzcGFuIGNsYXNzPVwiZmEgZmEtcGx1cy1jaXJjbGVcIj48L3NwYW4+JyksXG4gICAgICBvcGVuZWRJY29uOiAkKCc8c3BhbiBjbGFzcz1cImZhIGZhLW1pbnVzLWNpcmNsZVwiPjwvc3Bhbj4nKSxcblxuICAgICAgLy8gRmlyc3QgbGV2ZWwgb3BlblxuICAgICAgYXV0b09wZW46IG9wdGlvbnMuYXV0b09wZW4sXG4gICAgICBzZWxlY3RhYmxlOiBvcHRpb25zLnNlbGVjdGFibGUsXG5cbiAgICAgIC8vIEFzc2lnbiBkZXB0X2lkIGF0dHJpYnV0ZSB0byBlYWNoIHRyZWUgPGxpPlxuICAgICAgb25DcmVhdGVMaTogZnVuY3Rpb24gKG5vZGUsICRsaSkge1xuICAgICAgICAkbGkuYXR0cignZGVwdF9uaWQnLCBub2RlLmRlcHRfbmlkKTtcbiAgICAgICAgJGxpLmF0dHIoJ2RlcHRfaWQnLCBub2RlLmRlcHRfaWQpO1xuXG4gICAgICAgIGlmIChvcHRpb25zLnNob3dPbmx5ICYmIEFycmF5LmlzQXJyYXkob3B0aW9ucy5zaG93T25seSkgJiYgb3B0aW9ucy5zaG93T25seS5sZW5ndGgpIHtcbiAgICAgICAgICAkKGVsKS5hZGRDbGFzcygndHJpbW1lZCcpO1xuXG4gICAgICAgICAgJC5lYWNoKG9wdGlvbnMuc2hvd09ubHksIGZ1bmN0aW9uKGluZGV4LCBpdGVtKXtcbiAgICAgICAgICAgIGlmIChpdGVtID09IG5vZGUuZGVwdF9uaWQgfHwgbm9kZS5kZXB0X2lkID09ICdBU1UnKSB7XG4gICAgICAgICAgICAgICRsaS5hZGRDbGFzcygndmlzaWJsZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFub2RlLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAkbGkuZmluZCgnLmpxdHJlZS1lbGVtZW50JykucHJlcGVuZCgnPHNwYW4gY2xhc3M9XCJqcXRyZWUtZm9sZGVyLWljb24gZmEgZmEtYm9va21hcmtcIj48L3NwYW4+Jyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgICQoZWwpLmJpbmQoJ3RyZWUuc2VsZWN0JywgdGhpcy5vblRyZWVTZWxlY3QpO1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiYXN1LWRlcHQtdHJlZVwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0cmVlLWNvbnRhaW5lclwiIHJlZj1cInRyZWVDb250YWluZXJcIj48L2Rpdj5cbiAgICA8L2Rpdj5cbiAgfSxcblxuICBvblRyZWVTZWxlY3Q6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50Lm5vZGUpIHtcbiAgICAgIGV2ZW50Lm5vZGUudHJlZV9uaWRzID0gdGhpcy5nZXRUcmVlSWRzKGV2ZW50Lm5vZGUpO1xuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoeyBjdXJyZW50Tm9kZTogZXZlbnQubm9kZSB9KTtcbiAgICB0aGlzLnByb3BzLm9uVHJlZVNlbGVjdChldmVudCk7XG4gIH0sXG5cbiAgZ2V0RGVwdFBhdGg6IGZ1bmN0aW9uKGRlcHRfdGlkLCBwYXRoLCByZXZlcnNlKSB7XG4gICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICBjYXNlIDE6IHBhdGggPSBbXTtcbiAgICAgIGNhc2UgMjogcmV2ZXJzZSA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGl0ZW0gPSB0aGlzLmZpbmRSb290RGVwdChkZXB0X3RpZCwgJ3RpZCcpKSB7XG5cbiAgICAgIHZhciBjbGFzc05hbWUgPSBbJ2ZyYWdtZW50J107XG5cbiAgICAgIGlmIChpdGVtLnBhcmVudHNbMF0gPT0gJzAnKSB7XG4gICAgICAgIC8vIGFiYnJldmlhdGUgQXJpem9uYSBTdGF0ZSBVbml2ZXJzaXR5XG4gICAgICAgIGl0ZW0ubmFtZSA9ICdBU1UnO1xuICAgICAgICBjbGFzc05hbWUucHVzaCgnZmlyc3QnKTtcbiAgICAgIH1cbiAgICAgIGlmIChpdGVtLmNoaWxkcmVuLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgIGNsYXNzTmFtZS5wdXNoKCdsYXN0Jyk7XG4gICAgICB9XG5cbiAgICAgIHBhdGgucHVzaCg8c3BhbiBrZXk9e2RlcHRfdGlkfSBjbGFzc05hbWU9e2NsYXNzTmFtZS5qb2luKCcgJyl9PntpdGVtLm5hbWV9PC9zcGFuPik7XG4gICAgICBpZiAoaXRlbS5wYXJlbnRzLmxlbmd0aCkge1xuICAgICAgICBwYXRoID0gdGhpcy5nZXREZXB0UGF0aChpdGVtLnBhcmVudHNbMF0sIHBhdGgsIGZhbHNlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocmV2ZXJzZSkge1xuICAgICAgcGF0aCA9IHBhdGgucmV2ZXJzZSgpO1xuICAgIH1cblxuICAgIHJldHVybiBwYXRoO1xuICB9LFxuXG4gIGdldFRyZWVJZHM6IGZ1bmN0aW9uKHRyZWUsIHRyZWVfaWRzKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMSkge1xuICAgICAgdHJlZV9pZHMgPSBbXTtcbiAgICB9XG5cbiAgICB0cmVlX2lkcy5wdXNoKHRyZWUuZGVwdF9uaWQpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cmVlLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLmdldFRyZWVJZHModHJlZS5jaGlsZHJlbltpXSwgdHJlZV9pZHMpO1xuICAgIH1cblxuICAgIHJldHVybiB0cmVlX2lkcztcbiAgfSxcblxuICBmaW5kUm9vdERlcHQ6IGZ1bmN0aW9uKGRlcHRfaWQsIGlkX3R5cGUsIGRhdGEpIHtcbiAgICB2YXIgZGVwdCA9IG51bGw7XG5cbiAgICBzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgY2FzZSAxOlxuICAgICAgICBpZF90eXBlID0gJ2RlcHRfbmlkJztcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgZGF0YSA9IHRoaXMuc3RhdGUudHJlZURhdGE7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHtcbiAgICAgIGlkX3R5cGUgPSAnZGVwdF9uaWQnO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGRlcHQgPT0gbnVsbCAmJiBkYXRhW2ldICE9IG51bGwpIHtcbiAgICAgICAgaWYgKGRhdGFbaV1baWRfdHlwZV0gPT0gZGVwdF9pZCkge1xuICAgICAgICAgIHJldHVybiBkYXRhW2ldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRhdGFbaV0uaGFzT3duUHJvcGVydHkoJ2NoaWxkcmVuJykpIHtcbiAgICAgICAgICBkZXB0ID0gdGhpcy5maW5kUm9vdERlcHQoZGVwdF9pZCwgaWRfdHlwZSwgZGF0YVtpXS5jaGlsZHJlbik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRlcHQ7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBEZXBhcnRtZW50IFRyZWUgQ29tcG9uZW50XG4gKi9cbnZhciBEZXB0VHJlZSA9IHJlcXVpcmUoJy4vZGVwdC10cmVlJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICBpZiAoZS5rZXlDb2RlID09IDI3KSB7XG4gICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgfVxuICAgIH0uYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgb3BlbjogZmFsc2VcbiAgICB9XG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcblxuICAgIHZhciBtb2RhbENsYXNzID0gKHRoaXMuc3RhdGUub3BlbiA/ICdkaWFsb2ctb3BlbicgOiAnJyk7XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9e1wiYXN1LWRlcHQtcGlja2VyLW1vZGFsIFwiICsgbW9kYWxDbGFzc30+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImRpYWxvZ1wiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRpYWxvZy10aXRsZVwiPlxuICAgICAgICAgIHt0aGlzLnByb3BzLnRpdGxlfVxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2xvc2UtZGlhbG9nXCIgb25DbGljaz17dGhpcy5oYW5kbGVDYW5jZWxDbGlja30+XG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJmYSBmYS1jbG9zZVwiPjwvc3Bhbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIHt0aGlzLnByb3BzLmNvbnRlbnR9XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWN0aW9uc1wiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9ybS1pdGVtIGZvcm0tdHlwZS1jaGVja2JveFwiPlxuICAgICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgICByZWY9XCJpbmNsdWRlX3N1YmRlcHRcIlxuICAgICAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIlxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmb3JtLWNoZWNrYm94XCJcbiAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5oYW5kbGVTdWJkZXB0Q2xpY2t9XG4gICAgICAgICAgICAgIGRlZmF1bHRDaGVja2VkPXt0aGlzLnN0YXRlLmluY2x1ZGVTdWJkZXB0cyA/ICdjaGVja2VkJyA6ICcnfVxuICAgICAgICAgICAgLz4gXG4gICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwib3B0aW9uXCIgb25DbGljaz17dGhpcy5oYW5kbGVMYWJlbENsaWNrfT4gSW5jbHVkZSBzdWItZGVwYXJ0bWVudHM/PC9sYWJlbD5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZGVzY3JpcHRpb25cIiBzdHlsZT17eydkaXNwbGF5JzogJ25vbmUnfX0+XG4gICAgICAgICAgICAgIFRoaXMgd2lsbCBpbmNsdWRlIGFsbCBzdWItZGVwYXJ0bWVudHMgYmVuZWF0aCB0aGUgc2VsZWN0ZWQgZGVwYXJ0bWVudC5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxpbnB1dCB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImZvcm0tc3VibWl0XCJcbiAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlU3VibWl0Q2xpY2t9XG4gICAgICAgICAgICB2YWx1ZT1cIlN1Ym1pdFwiXG4gICAgICAgICAgLz5cbiAgICAgICAgICA8aW5wdXQgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJmb3JtLXN1Ym1pdFwiXG4gICAgICAgICAgICBvbkNsaWNrPXt0aGlzLmhhbmRsZUNhbmNlbENsaWNrfVxuICAgICAgICAgICAgdmFsdWU9XCJDYW5jZWxcIlxuICAgICAgICAgIC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIH0sXG5cbiAgaGFuZGxlU3ViZGVwdENsaWNrOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5wcm9wcy5vblN1YmRlcHRDbGljaykge1xuICAgICAgdGhpcy5wcm9wcy5vblN1YmRlcHRDbGljaygpO1xuICAgIH1cbiAgfSxcblxuICBoYW5kbGVMYWJlbENsaWNrOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnJlZnMuaW5jbHVkZV9zdWJkZXB0LmNsaWNrKCk7XG4gIH0sXG5cbiAgaGFuZGxlQ2FuY2VsQ2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLnByb3BzLm9uQ2FuY2VsQ2xpY2spIHtcbiAgICAgIHRoaXMucHJvcHMub25DYW5jZWxDbGljaygpO1xuICAgIH1cblxuICAgIHRoaXMuaGlkZSgpO1xuICB9LFxuXG4gIGhhbmRsZVN1Ym1pdENsaWNrOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5wcm9wcy5vblN1Y2Nlc3MpIHtcbiAgICAgIHRoaXMucHJvcHMub25TdWNjZXNzKCk7XG4gICAgfVxuXG4gICAgdGhpcy5oaWRlKCk7XG4gIH0sXG5cbiAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IG9wZW46IHRydWUgfSk7XG4gIH0sXG5cbiAgaGlkZTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IG9wZW46IGZhbHNlIH0pO1xuICB9XG59KTsiXX0=
